const a0_0x118410=a0_0x3d38;(function(_0x221004,_0x290f0f){const _0x40bd59=a0_0x3d38,_0x151861=_0x221004();while(!![]){try{const _0x1fce4a=-parseInt(_0x40bd59(0x1d4))/0x1*(parseInt(_0x40bd59(0x1fa))/0x2)+parseInt(_0x40bd59(0x1f1))/0x3*(-parseInt(_0x40bd59(0x210))/0x4)+-parseInt(_0x40bd59(0x1f4))/0x5*(-parseInt(_0x40bd59(0x1f6))/0x6)+parseInt(_0x40bd59(0x1d1))/0x7*(-parseInt(_0x40bd59(0x1f2))/0x8)+parseInt(_0x40bd59(0x1eb))/0x9*(-parseInt(_0x40bd59(0x1e8))/0xa)+parseInt(_0x40bd59(0x1fb))/0xb*(-parseInt(_0x40bd59(0x1e0))/0xc)+parseInt(_0x40bd59(0x1df))/0xd;if(_0x1fce4a===_0x290f0f)break;else _0x151861['push'](_0x151861['shift']());}catch(_0xc0177b){_0x151861['push'](_0x151861['shift']());}}}(a0_0x8cf2,0x23d8e));const express=require(a0_0x118410(0x20b)),cors=require(a0_0x118410(0x1ff)),multer=require('multer'),nodemailer=require(a0_0x118410(0x1fe)),Papa=require(a0_0x118410(0x1dc)),fs=require('fs'),path=require(a0_0x118410(0x20e)),app=express();app['use'](cors()),app['use'](express['json']()),app['use'](express[a0_0x118410(0x1e5)]({'extended':!![]}));function a0_0x8cf2(){const _0x2be15d=['push','sendMail','📋\x20Parsed\x20Data:','filename','urlencoded','attachments','listen','67630XmCDKh','replace','email','99DTEkKB','existsSync','📑\x20Processing\x20CSV:','json','✅\x20Email\x20sent\x20to:\x20','filter','11685lCuBIK','20984xgsPMr','undefined','5iVXflE','includes','548520cwIhIR','log','there','csvFile','521546aqkwOy','2135815ySVSyR','name','popup.html','nodemailer','cors','gmail','/send-emails','sendFile','body','files','dirname','readFileSync','Hello,\x20','attachment','⚠️\x20Public\x20folder\x20not\x20found!\x20Ensure\x20it\x20is\x20included.','split','express','🚀\x20Server\x20running\x20on\x20http://localhost:5000','join','path','trim','184rJqAPb','map','301akVNKK','post','❌\x20Failed\x20to\x20send\x20email\x20to\x20','1xOiDIL','Missing\x20required\x20fields','originalname','execPath','📩\x20Received\x20request:','\x20with\x20attachments:','❌\x20Missing\x20required\x20fields','data','papaparse','uploads','static','11397100HZbPgm','12zHtfvT'];a0_0x8cf2=function(){return _0x2be15d;};return a0_0x8cf2();}const isPkg=typeof process['pkg']!==a0_0x118410(0x1f3),basePath=isPkg?path[a0_0x118410(0x205)](process[a0_0x118410(0x1d7)]):__dirname,publicPath=path[a0_0x118410(0x20d)](basePath,'public'),uploadPath=path[a0_0x118410(0x20d)](basePath,a0_0x118410(0x1dd));!fs[a0_0x118410(0x1ec)](publicPath)&&console['error'](a0_0x118410(0x209));!fs[a0_0x118410(0x1ec)](uploadPath)&&fs['mkdirSync'](uploadPath,{'recursive':!![]});function a0_0x3d38(_0x4fb15d,_0x31a3b3){const _0x8cf2fa=a0_0x8cf2();return a0_0x3d38=function(_0x3d3811,_0x4adfdc){_0x3d3811=_0x3d3811-0x1d0;let _0xd7b6ec=_0x8cf2fa[_0x3d3811];return _0xd7b6ec;},a0_0x3d38(_0x4fb15d,_0x31a3b3);}const upload=multer({'dest':uploadPath});app[a0_0x118410(0x1d2)](a0_0x118410(0x201),upload['fields']([{'name':a0_0x118410(0x1f9)},{'name':a0_0x118410(0x1e6)}]),async(_0x19ff91,_0x2c33e4)=>{const _0x31f781=a0_0x118410;console[_0x31f781(0x1f7)](_0x31f781(0x1d8),_0x19ff91[_0x31f781(0x203)]);const {senderEmail:_0xe5dcc7,senderPassword:_0x304b3c,subject:_0x35bde9,emailBody:_0x5cd6fe}=_0x19ff91[_0x31f781(0x203)],_0x5aaaae=_0x19ff91[_0x31f781(0x204)][_0x31f781(0x1f9)]?_0x19ff91[_0x31f781(0x204)][_0x31f781(0x1f9)][0x0]:null,_0x3f232b=_0x19ff91['files'][_0x31f781(0x1e6)]||[];if(!_0xe5dcc7||!_0x304b3c||!_0x5aaaae)return console['error'](_0x31f781(0x1da)),_0x2c33e4[_0x31f781(0x1ee)]({'success':![],'message':_0x31f781(0x1d5)});console[_0x31f781(0x1f7)](_0x31f781(0x1ed),_0x5aaaae[_0x31f781(0x20e)]);const _0x356865=fs[_0x31f781(0x206)](_0x5aaaae[_0x31f781(0x20e)],'utf8'),_0x596589=Papa['parse'](_0x356865,{'header':!![]})[_0x31f781(0x1db)];console[_0x31f781(0x1f7)](_0x31f781(0x1e3),_0x596589);let _0x2808c1=nodemailer['createTransport']({'service':_0x31f781(0x200),'auth':{'user':_0xe5dcc7,'pass':_0x304b3c}}),_0x464e30=[],_0x1ade97=[];for(const _0x3ba24e of _0x596589){const _0x3f5443=_0x3ba24e[_0x31f781(0x1ea)]?.['trim'](),_0x541c8d=_0x3ba24e[_0x31f781(0x1fc)]?.[_0x31f781(0x20f)]()||_0x31f781(0x1f8),_0x4d70fd=_0x3ba24e['attachment']?_0x3ba24e[_0x31f781(0x208)][_0x31f781(0x20a)](',')['map'](_0x5bc413=>_0x5bc413[_0x31f781(0x20f)]()):[];if(!_0x3f5443){console['warn']('⚠️\x20Skipping\x20row:\x20No\x20recipient\x20email\x20found',_0x3ba24e);continue;}let _0x2dadf3=_0x5cd6fe[_0x31f781(0x1e9)](/{{name}}/g,_0x541c8d),_0x3e8312=_0x3f232b[_0x31f781(0x1f0)](_0x595599=>_0x4d70fd[_0x31f781(0x1f5)](_0x595599[_0x31f781(0x1d6)]))[_0x31f781(0x1d0)](_0x1f7eb4=>({'filename':_0x1f7eb4[_0x31f781(0x1d6)],'path':_0x1f7eb4['path']})),_0x26cc29={'from':_0xe5dcc7,'to':_0x3f5443,'subject':_0x35bde9||_0x31f781(0x207)+_0x541c8d,'text':_0x2dadf3,'attachments':_0x3e8312};try{await _0x2808c1[_0x31f781(0x1e2)](_0x26cc29),console[_0x31f781(0x1f7)](_0x31f781(0x1ef)+_0x3f5443+_0x31f781(0x1d9),_0x3e8312[_0x31f781(0x1d0)](_0x35b5f3=>_0x35b5f3[_0x31f781(0x1e4)])),_0x464e30[_0x31f781(0x1e1)]({'recipient':_0x3f5443,'attachments':_0x3e8312['map'](_0x57e5f6=>_0x57e5f6[_0x31f781(0x1e4)])});}catch(_0x5521e4){console['error'](_0x31f781(0x1d3)+_0x3f5443+':',_0x5521e4),_0x1ade97[_0x31f781(0x1e1)]({'recipient':_0x3f5443,'error':_0x5521e4['message']});}}_0x2c33e4[_0x31f781(0x1ee)]({'success':!![],'message':'Emails\x20processed!','sentEmails':_0x464e30,'failedEmails':_0x1ade97});}),app['use'](express[a0_0x118410(0x1de)](publicPath)),app['get']('/',(_0x21c07f,_0x524c56)=>{const _0x3bdf67=a0_0x118410;_0x524c56[_0x3bdf67(0x202)](path[_0x3bdf67(0x20d)](publicPath,_0x3bdf67(0x1fd)));}),app[a0_0x118410(0x1e7)](0x1388,()=>{const _0x235038=a0_0x118410;console[_0x235038(0x1f7)](_0x235038(0x20c));});
